@app.route("/")
def dashboard():
    prices = get_prices()
    scores = calculate_scores(prices)

    total_positions_value = sum(
        positions[s]['qty'] * prices.get(s, positions[s]['entry'])
        for s in positions
    )
    total_equity = cash + total_positions_value

    sorted_scores = sorted(scores.items(), key=lambda x: x[1], reverse=True)

    return f"""
    <html>
    <head>
    <meta http-equiv="refresh" content="5">
    <style>
    body {{ background:#0f2027; color:white; font-family:Arial; padding:20px; }}
    h1 {{ color:gold; }}
    .card {{ background:#1c3b45; padding:20px; margin-bottom:20px; border-radius:10px; }}
    table {{ width:100%; border-collapse:collapse; }}
    th, td {{ padding:8px; border-bottom:1px solid #333; }}
    .green {{ color:#00ff99; }}
    .red {{ color:#ff4d4d; }}
    </style>
    </head>
    <body>

    <h1>ðŸ”¥ ELITE TOP-35 ADAPTIVE AI</h1>

    <div class="card">
    <b>Cash:</b> ${cash:.2f}<br>
    <b>Positions Value:</b> ${total_positions_value:.2f}<br>
    <b>Total Equity:</b> ${total_equity:.2f}<br><br>
    Trades: {trades} | Wins: {wins} | Losses: {losses}<br>
    Entry Threshold: {entry_threshold:.4f}
    </div>

    <div class="card">
    <h3>Live Market Scores</h3>
    <table>
    <tr><th>Coin</th><th>Price</th><th>Score</th></tr>
    {''.join(f"<tr><td>{s}</td><td>${prices.get(s,0):.4f}</td><td>{score:.4f}</td></tr>" for s,score in sorted_scores)}
    </table>
    </div>

    </body>
    </html>
    """